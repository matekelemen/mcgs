<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MCGS: MCGS - Multicolor Gauss-Seidel Smoother</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MCGS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">MCGS - Multicolor Gauss-Seidel Smoother </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_readme"></a> MCGS is a lightweight library for performing parallelized Gauss-Sidel smoothing, focusing on sparse systems with imbalanced topologies. Implementations for related tasks such as graph coloring and reordering are included as well.</p>
<p style="display: flex; justify-content: center; align-items: center;"></p>
<p><img src="../../.github/assets/matrix.png" alt="" width="300/" class="inline"/> <img src="../../.github/assets/right_arrow.png" alt="" width="100" style="object-fit: scale-down;" class="inline"/> <img src="../../.github/assets/matrix_reordered.png" alt="" width="300/" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Features</h1>
<ul>
<li>Gauss-Seidel iterations in parallel (OpenMP) or serial</li>
<li>SOR (successive over-relaxation) in parallel (OpenMP) or serial</li>
<li>Graph coloring in parallel (loose implementation of <code>doi:10.1006/jagm.2000.1097</code>)</li>
<li>Matrix/vector reordering and reverse reordering</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Usage</h1>
<p>Typical workflow</p>
<ul>
<li>construct your linear system \(A x = b\)</li>
<li>construct and adaptor for \(A\) (see <a href="../../docs/html/structmcgs_1_1CSRAdaptor.html">mcgs::CSRAdaptor</a>)</li>
<li>compute a coloring of \(A\) (see <a href="../../docs/html/namespacemcgs.html#ad660f970843b8c8edea18c6e9291f6e5">mcgs::color</a>)</li>
<li>construct a partition of \(A\) with respect to the coloring (see <a href="../../docs/html/namespacemcgs.html#adbeb4189f3eadcb713e803cf94aa38cf">mcgs::makePartition</a>)</li>
<li>reorder the system with respect to the coloring (see <a href="../../docs/html/namespacemcgs.html#a5291808c16a69190ac0bb31a1f3ee81d">mcgs::reorder</a>)</li>
<li>perform Gauss-Seidel iterations <b>using the reordered partition</b> (see <a href="../../docs/html/namespacemcgs.html#ae862fac411e001950f012872f6ac7e0c">mcgs::solve</a>)</li>
<li><em>optional: restore the original order of your system</em> (see <a href="../../docs/html/namespacemcgs.html#aa5b1a78cfa8d230b2100320dde50f3c7">mcgs::revertReorder</a>)</li>
<li>deallocate partitions (see <a href="../../docs/html/namespacemcgs.html#ad619ded9f67d8a9f379ad7e4b759d854">mcgs::destroyPartition</a>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
C++ Example Snippet</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="mcgs_8hpp.html">mcgs/mcgs.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Any CSR matrix will do but for the sake of familiarity, let&#39;s assume you&#39;re using Eigen.</span></div>
<div class="line">Eigen::SparseMatrix&lt;double,Eigen::RowMajor&gt; A;  <span class="comment">// &lt;== left hand side matrix</span></div>
<div class="line">Eigen::Matrix&lt;double,Eigen::Dynamic,1&gt; b;       <span class="comment">// &lt;== right hand side vector</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Construct an adaptor for your matrix.</span></div>
<div class="line"><a class="code" href="structmcgs_1_1CSRAdaptor.html">mcgs::CSRAdaptor</a>&lt;<span class="comment">/*index type=*/</span> int, <span class="comment">/*value type=*/</span><span class="keywordtype">double</span>&gt; adaptor;</div>
<div class="line">adaptor.<a class="code" href="structmcgs_1_1CSRAdaptor.html#ae2dd01c5485f57bacc1328afa1b9d5c6">rowCount</a>        = A.rows();</div>
<div class="line">adaptor.columnCount     = A.cols();</div>
<div class="line">adaptor.entryCount      = A.nonZeros();</div>
<div class="line">adaptor.pRowExtents     = A.outerIndexPtr();</div>
<div class="line">adaptor.pColumnIndices  = A.innerIndexPtr();</div>
<div class="line">adaptor.pEntries        = A.innerNonZeroPtr();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Color the rows of your matrix.</span></div>
<div class="line">std::vector&lt;unsigned&gt; colors(adaptor.rowCount);</div>
<div class="line"><a class="code" href="namespacemcgs.html#ad660f970843b8c8edea18c6e9291f6e5">mcgs::color</a>(colors.data(),</div>
<div class="line">            adaptor,</div>
<div class="line">            <a class="code" href="structmcgs_1_1ColorSettings.html">mcgs::ColorSettings</a> {});</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Construct a partition for your matrix with respect to the coloring,</span></div>
<div class="line"><span class="comment">// and reorder the system accordingly. Note that this mutates your original matrix!</span></div>
<div class="line"><span class="keyword">auto</span> pPartition = <a class="code" href="namespacemcgs.html#a1f1b31c2c7598785869990911fc47d26">mcgs::makePartition</a>(colors.data(), adaptor.rowCount);</div>
<div class="line"><span class="keyword">auto</span> pReorderedPartition = <a class="code" href="namespacemcgs.html#a17236ad40bf333770b858d20b1e860fb">mcgs::reorder</a>(A.rows(), A.cols(), A.nonZeros(),</div>
<div class="line">                                         A.outerIndexPtr(), A.innerIndexPtr(), A.innerNonZeroPtr(),</div>
<div class="line">                                         b.data());</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Do 10 Gauss-Seidel iterations.</span></div>
<div class="line">std::vector&lt;double&gt; x(adaptor.columnCount);</div>
<div class="line"><a class="code" href="structmcgs_1_1SolveSettings.html">mcgs::SolveSettings</a>&lt;<span class="comment">/*index type=*/</span>int, <span class="comment">/*value type=*/</span><span class="keywordtype">double</span>&gt; settings;</div>
<div class="line">settings.maxIterations = 10;</div>
<div class="line">settings.parallelization = <a class="code" href="namespacemcgs.html#a06ea4c8469385d263f5414c804d23e86ae7968e8fd57987542f4a09aafaf672c7">mcgs::Parallelization::RowWise</a>; <span class="comment">// &lt;== default parallelization strategy, check out the other ones as well.</span></div>
<div class="line"><a class="code" href="namespacemcgs.html#a87a15788e753a30cc3f8f621ba2a48fb">mcgs::solve</a>(x.data(), adaptor, b.data(), pReorderedPartition, settings);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Optional: if you need to recover your original system,</span></div>
<div class="line"><span class="comment">//           you need to undo the reordering.</span></div>
<div class="line"><span class="comment">// See mcgs::revertReorder</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Cleanup</span></div>
<div class="line"><a class="code" href="namespacemcgs.html#ad619ded9f67d8a9f379ad7e4b759d854">mcgs::destroyPartition</a>(pPartition);</div>
<div class="line"><a class="code" href="namespacemcgs.html#ad619ded9f67d8a9f379ad7e4b759d854">mcgs::destroyPartition</a>(pReorderedPartition);</div>
<div class="ttc" id="amcgs_8hpp_html"><div class="ttname"><a href="mcgs_8hpp.html">mcgs.hpp</a></div></div>
<div class="ttc" id="anamespacemcgs_html_a06ea4c8469385d263f5414c804d23e86ae7968e8fd57987542f4a09aafaf672c7"><div class="ttname"><a href="namespacemcgs.html#a06ea4c8469385d263f5414c804d23e86ae7968e8fd57987542f4a09aafaf672c7">mcgs::Parallelization::RowWise</a></div><div class="ttdeci">@ RowWise</div><div class="ttdoc">Distribute work assuming each row has the same number of entries.</div></div>
<div class="ttc" id="anamespacemcgs_html_a17236ad40bf333770b858d20b1e860fb"><div class="ttname"><a href="namespacemcgs.html#a17236ad40bf333770b858d20b1e860fb">mcgs::reorder</a></div><div class="ttdeci">MCGS_EXPORT_SYMBOL Partition&lt; TIndex &gt; * reorder(const unsigned long rowCount, const unsigned long columnCount, const unsigned long entryCount, TIndex *pRowExtents, TIndex *pColumnIndices, TValue *pEntries, TValue *pSolution, TValue *pRHS, const Partition&lt; TIndex &gt; *pPartition)</div><div class="ttdoc">Reorder rows and columns of a CSR matrix as well as a matching dense vector, with respect to a colori...</div></div>
<div class="ttc" id="anamespacemcgs_html_a1f1b31c2c7598785869990911fc47d26"><div class="ttname"><a href="namespacemcgs.html#a1f1b31c2c7598785869990911fc47d26">mcgs::makePartition</a></div><div class="ttdeci">MCGS_EXPORT_SYMBOL Partition&lt; TIndex &gt; * makePartition(const TColor *pColors, const TIndex rowCount)</div><div class="ttdoc">Construct the Partition of a graph with respect to a coloring.</div></div>
<div class="ttc" id="anamespacemcgs_html_a87a15788e753a30cc3f8f621ba2a48fb"><div class="ttname"><a href="namespacemcgs.html#a87a15788e753a30cc3f8f621ba2a48fb">mcgs::solve</a></div><div class="ttdeci">MCGS_EXPORT_SYMBOL int solve(TValue *pSolution, const CSRAdaptor&lt; TIndex, TValue &gt; &amp;rMatrix, const TValue *pRHS, const SolveSettings&lt; TIndex, TValue &gt; settings)</div><div class="ttdoc">Perform Gauss-Seidel relaxation in serial.</div></div>
<div class="ttc" id="anamespacemcgs_html_ad619ded9f67d8a9f379ad7e4b759d854"><div class="ttname"><a href="namespacemcgs.html#ad619ded9f67d8a9f379ad7e4b759d854">mcgs::destroyPartition</a></div><div class="ttdeci">MCGS_EXPORT_SYMBOL void destroyPartition(Partition&lt; TIndex &gt; *pPartition)</div><div class="ttdoc">Destroy a partition that was successfully constructed by makePartition.</div></div>
<div class="ttc" id="anamespacemcgs_html_ad660f970843b8c8edea18c6e9291f6e5"><div class="ttname"><a href="namespacemcgs.html#ad660f970843b8c8edea18c6e9291f6e5">mcgs::color</a></div><div class="ttdeci">MCGS_EXPORT_SYMBOL int color(TColor *pColors, const CSRAdaptor&lt; TIndex, TValue &gt; &amp;rMatrix, const ColorSettings&lt; TValue &gt; settings)</div><div class="ttdoc">Compute an approximate coloring of a graph.</div></div>
<div class="ttc" id="astructmcgs_1_1CSRAdaptor_html"><div class="ttname"><a href="structmcgs_1_1CSRAdaptor.html">mcgs::CSRAdaptor</a></div><div class="ttdoc">Adaptor for matrices stored in the compressed sparse row format.</div><div class="ttdef"><b>Definition:</b> mcgs.hpp:41</div></div>
<div class="ttc" id="astructmcgs_1_1CSRAdaptor_html_ae2dd01c5485f57bacc1328afa1b9d5c6"><div class="ttname"><a href="structmcgs_1_1CSRAdaptor.html#ae2dd01c5485f57bacc1328afa1b9d5c6">mcgs::CSRAdaptor::rowCount</a></div><div class="ttdeci">unsigned long rowCount</div><div class="ttdoc">Number of rows in the matrix.</div><div class="ttdef"><b>Definition:</b> mcgs.hpp:42</div></div>
<div class="ttc" id="astructmcgs_1_1ColorSettings_html"><div class="ttname"><a href="structmcgs_1_1ColorSettings.html">mcgs::ColorSettings</a></div><div class="ttdoc">Settings for the coloring algorithm.</div><div class="ttdef"><b>Definition:</b> mcgs.hpp:65</div></div>
<div class="ttc" id="astructmcgs_1_1SolveSettings_html"><div class="ttname"><a href="structmcgs_1_1SolveSettings.html">mcgs::SolveSettings</a></div><div class="ttdoc">Settings for Gauss-Seidel relaxation.</div><div class="ttdef"><b>Definition:</b> mcgs.hpp:367</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Requirements</h1>
<ul>
<li>C++ compiler with full C++17 support (GCC, Clang and MSVC are tested)</li>
<li>CMake version 3.15 or later</li>
<li>[optional] OpenMP 2.0 or later for shared memory parallelization</li>
<li>Linux, MacOS or Windows</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Installation</h1>
<p>MCGS is written in C++ and uses CMake as its build system. Building produces a single shared library and matching header.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Build and Install</h2>
<div class="fragment"><div class="line">cmake &lt;path-to-mcgs-source&gt;                       \</div>
<div class="line">      -B&lt;path-to-build-dir&gt;                       \</div>
<div class="line">      -DCMAKE_INSTALL_PREFIX=&lt;your-install-dir&gt;   \</div>
<div class="line">      -DCMAKE_BUILD_TYPE=Release                  \</div>
<div class="line">      -DMCGS_SHARED_MEMORY_PARALLELISM=OpenMP</div>
<div class="line"> </div>
<div class="line">cmake &lt;path-to-build-dir&gt; --build --target install</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Build options</h2>
<ul>
<li>CMake options for <code>MCGS_SHARED_MEMORY_PARALLELISM</code><ul>
<li><code>None</code>: no parallelization</li>
<li><code>OpenMP</code>: use OpenMP for shared memory parallelization</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md8"></a>
Include MCGS in a CMake project</h2>
<div class="fragment"><div class="line">find_package(MCGS REQUIRED)</div>
<div class="line">target_link_libraries(&lt;your_target&gt; PRIVATE mcgs)</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
